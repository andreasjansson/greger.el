## SYSTEM:

You can run arbitrary shell commands with the shell-command tool, but the following are safe shell commands that will run without user confirmation:

* `bash script/package-lint`
* `bash script/test --verbose`
* `bash script/test --verbose --file test/test-greger.el`
* `bash script/test --verbose --file test/test-greger-lib-lsp.el`


<safe-shell-commands>
bash script/package-lint
bash script/test --verbose
bash script/test --verbose --file test/test-greger.el
bash script/test --verbose --file test/test-greger-lib-lsp.el
</safe-shell-commands>


## USER:

Here are docs for the setup-emacs github action: https://github.com/marketplace/actions/set-up-emacs

And example usage: https://raw.githubusercontent.com/company-mode/company-mode/1924eabfa7438974da0500e85fff5fb32c27282c/.github/workflows/ci.yml

Make a github action that runs ./script/test on main and PR pushes

## ASSISTANT:

I'll help you create a GitHub Action that runs `./script/test` on main and PR pushes. Let me first examine the documentation and example you provided, then create the workflow file.

## TOOL USE:

Name: read-webpage
ID: toolu_01Cnx1Ecs794qdFk2HPjyj3E

### url

<tool.toolu_01Cnx1Ecs794qdFk2HPjyj3E>
https://github.com/marketplace/actions/set-up-emacs
</tool.toolu_01Cnx1Ecs794qdFk2HPjyj3E>

## TOOL RESULT:

ID: toolu_01Cnx1Ecs794qdFk2HPjyj3E

<tool.toolu_01Cnx1Ecs794qdFk2HPjyj3E>
    Skip to content
    Navigation Menu
   Toggle navigation




            Sign in
               Appearance settings




        Product

            GitHub Copilot


        Write better code with AI



            GitHub Models

                New


        Manage and compare prompts



            GitHub Advanced Security


        Find and fix vulnerabilities



            Actions


        Automate any workflow



            Codespaces


        Instant dev environments






            Issues


        Plan and track work



            Code Review


        Manage code changes



            Discussions


        Collaborate outside of code



            Code Search


        Find more, search less





    Explore
      Why GitHub




      All features




      Documentation



      GitHub Skills



      Blog








        Solutions
              By company size
      Enterprises




      Small and medium teams




      Startups




      Nonprofits





   By use case
      DevSecOps




      DevOps




      CI/CD




      View all use cases






    By industry
      Healthcare




      Financial services




      Manufacturing




      Government




      View all industries







              View all solutions




        Resources
              Topics
      AI




      DevOps




      Security




      Software Development




      View all






    Explore
      Learning Pathways



      Events & Webinars



      Ebooks & Whitepapers




      Customer Stories




      Partners



      Executive Insights









        Open Source

            GitHub Sponsors


        Fund open source developers





            The ReadME Project


        GitHub community articles




   Repositories
      Topics




      Trending




      Collections









        Enterprise

            Enterprise platform


        AI-powered developer platform




   Available add-ons
            GitHub Advanced Security


        Enterprise-grade security features



            Copilot for business


        Enterprise-grade AI features



            Premium Support


        Enterprise-grade 24/7 support







   Pricing


  Search or jump to...
     Search code, repositories, users, issues, pull requests...
      '"`   </textarea></xmp>
        Search




  Clear





    Search syntax tips








        Provide feedback





    '"`   </textarea></xmp>   We read every piece of feedback, and take your input very seriously.
    Include my email address so I can be contacted
       Cancel
      Submit feedback


        Saved searches

  Use saved searches to filter your results more quickly





    '"`   </textarea></xmp>
    Name
   Query

            To see all available qualifiers, see our  documentation .





       Cancel
      Create saved search



                Sign in


                Sign up
                   Appearance settings

  Resetting focus



    You signed in with another tab or window.  Reload  to refresh your session.  You signed out in another tab or window.  Reload  to refresh your session.  You switched accounts on another tab or window.  Reload  to refresh your session.    Dismiss alert


         {{ message }}




     Marketplace
 Actions
 Set up Emacs




 Set up Emacs
 Actions

 Install a specific Emacs version for use in your workflow
  v6.0
 Latest


 By  purcell



  Star 148 ¬†(  148  ) You must be signed in to star a repository Use   latest version
  Choose a version


 Tags
 2 ¬†(  2  )
 continuous-integration testing







  A Github Action that installs a specific emacs version

  Uses  nix-emacs-ci  to provide binaries for a number of different Emacs versions.
  Since that project uses Nix, Nix will be installed automatically if
necessary.
  Note also that only Linux and MacOS are supported, since Nix is not
available on Windows.
  Check out  examples of using this Action in the wild in 1500+ repositories .
  See the  actions tab  for runs of this action! üöÄ
  Usage:

  uses :  purcell/setup-emacs@master  with :
   version :  24.5

  The  emacs  executable on the path will then be the requested
version. For a list of available versions, please see the
 nix-emacs-ci  project.
  For an example of real-life usage, see the  Actions config for  package-lint .

 Note about compiling binary emacs modules

  Here's an example  of a project which compiles binary modules against an Emacs installed with this method.
  üíù Support this project and my other Open Source work via Patreon
  üíº LinkedIn profile
  ‚úç sanityinc.com


 Contributors 4 ¬†(  4  )



 Resources

    Open an issue 3 ¬†(  3  )
   Pull requests 0 ¬†(  0  )
   View source code
   Report abuse


 Set up Emacs  is not certified by GitHub. It is provided by a third-party and is governed by separate terms of service, privacy policy, and support documentation.






 About

 Install a specific Emacs version for use in your workflow
  v6.0
 Latest


 By  purcell


 Tags
 2 ¬†(  2  )
 continuous-integration testing

 Contributors 4 ¬†(  4  )



 Resources

    Open an issue 3 ¬†(  3  )
   Pull requests 0 ¬†(  0  )
   View source code
   Report abuse


 Set up Emacs  is not certified by GitHub. It is provided by a third-party and is governed by separate terms of service, privacy policy, and support documentation.













    You can‚Äôt perform that action at this time.









</tool.toolu_01Cnx1Ecs794qdFk2HPjyj3E>

## TOOL USE:

Name: read-webpage
ID: toolu_01PiHe8oKRb9VQURNH95GbT7

### url

<tool.toolu_01PiHe8oKRb9VQURNH95GbT7>
https://raw.githubusercontent.com/company-mode/company-mode/1924eabfa7438974da0500e85fff5fb32c27282c/.github/workflows/ci.yml
</tool.toolu_01PiHe8oKRb9VQURNH95GbT7>

### extract_text

<tool.toolu_01PiHe8oKRb9VQURNH95GbT7>
:json-false
</tool.toolu_01PiHe8oKRb9VQURNH95GbT7>

## TOOL RESULT:

ID: toolu_01PiHe8oKRb9VQURNH95GbT7

<tool.toolu_01PiHe8oKRb9VQURNH95GbT7>
name: CI

on:
  push:
    paths:
      - '**.el'
      - '**ci.yml'
      - 'Makefile'
    branches:
      - master

  pull_request:
    paths:
      - '**.el'
      - '**ci.yml'
      - 'Makefile'
    branches:
      - master

jobs:
  check:
    runs-on: ubuntu-latest

    strategy:
      fail-fast: false
      matrix:
        emacs_version: [26.1, 26.3, 27.2, 28.2, 29.4, 30.1, snapshot]

    steps:
      - name: Setup Emacs
        uses: purcell/setup-emacs@master
        with:
          version: ${{ matrix.emacs_version }}

      - name: Checkout Company
        uses: actions/checkout@v3

      - name: Run tests
        run: make test-batch

      - name: Run compilation
        run: make compile-warn


</tool.toolu_01PiHe8oKRb9VQURNH95GbT7>

## ASSISTANT:

Now let me check the current directory structure to see if there's already a `.github/workflows` directory:

## TOOL USE:

Name: list-directory
ID: toolu_012bRcjjvstyo32fxZweFubt

### path

<tool.toolu_012bRcjjvstyo32fxZweFubt>
.
</tool.toolu_012bRcjjvstyo32fxZweFubt>

## TOOL RESULT:

ID: toolu_012bRcjjvstyo32fxZweFubt

<tool.toolu_012bRcjjvstyo32fxZweFubt>
README.md
chat.ai
greger-client.el
greger-lib-lsp.el
greger-parser.el
greger-pkg.el
greger-stdlib.el
greger-tools.el
greger-web.el
greger.el
recipes/
script/
test/
</tool.toolu_012bRcjjvstyo32fxZweFubt>

## TOOL USE:

Name: list-directory
ID: toolu_01RbhxeFAciSpeQTYJLz7Pwe

### path

<tool.toolu_01RbhxeFAciSpeQTYJLz7Pwe>
script
</tool.toolu_01RbhxeFAciSpeQTYJLz7Pwe>

## TOOL RESULT:

ID: toolu_01RbhxeFAciSpeQTYJLz7Pwe

<tool.toolu_01RbhxeFAciSpeQTYJLz7Pwe>
package-lint
test
</tool.toolu_01RbhxeFAciSpeQTYJLz7Pwe>

## ASSISTANT:

Let me also check if there's a `.github` directory:

## TOOL USE:

Name: list-directory
ID: toolu_01RHVmWTCH2HngDuddzGiHZr

### path

<tool.toolu_01RHVmWTCH2HngDuddzGiHZr>
.
</tool.toolu_01RHVmWTCH2HngDuddzGiHZr>

### show-hidden

<tool.toolu_01RHVmWTCH2HngDuddzGiHZr>
true
</tool.toolu_01RHVmWTCH2HngDuddzGiHZr>

## TOOL RESULT:

ID: toolu_01RHVmWTCH2HngDuddzGiHZr

<tool.toolu_01RHVmWTCH2HngDuddzGiHZr>
README.md
chat.ai
greger-client.el
greger-lib-lsp.el
greger-parser.el
greger-pkg.el
greger-stdlib.el
greger-tools.el
greger-web.el
greger.el
recipes/
script/
test/
</tool.toolu_01RHVmWTCH2HngDuddzGiHZr>

## ASSISTANT:

Now I'll create the GitHub Action workflow. Based on the documentation and example, I'll create a CI workflow that:
1. Runs on pushes to main and pull requests
2. Uses the setup-emacs action
3. Tests against multiple Emacs versions
4. Runs the `./script/test` command

## TOOL USE:

Name: make-directory
ID: toolu_01QEkQ239xF2fCADQrEJiZ7S

### path

<tool.toolu_01QEkQ239xF2fCADQrEJiZ7S>
.github/workflows
</tool.toolu_01QEkQ239xF2fCADQrEJiZ7S>

### git_commit_message

<tool.toolu_01QEkQ239xF2fCADQrEJiZ7S>
Create .github/workflows directory for CI
</tool.toolu_01QEkQ239xF2fCADQrEJiZ7S>

<!-- TOOL_RESULT_PLACEHOLDER_toolu_01QEkQ239xF2fCADQrEJiZ7S -->
